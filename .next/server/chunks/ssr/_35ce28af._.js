module.exports=[99602,96818,18956,a=>{"use strict";a.s(["toDate",()=>h],99602),a.s(["constructFrom",()=>g],18956),a.s(["constructFromSymbol",()=>f,"millisecondsInDay",()=>c,"millisecondsInHour",()=>e,"millisecondsInMinute",()=>d,"millisecondsInWeek",()=>b],96818);let b=6048e5,c=864e5,d=6e4,e=36e5,f=Symbol.for("constructDateFrom");function g(a,b){return"function"==typeof a?a(b):a&&"object"==typeof a&&f in a?a[f](b):a instanceof Date?new a.constructor(b):new Date(b)}function h(a,b){return g(b||a,a)}},47355,a=>{"use strict";a.s(["normalizeDates",()=>c]);var b=a.i(18956);function c(a,...d){let e=b.constructFrom.bind(null,a||d.find(a=>"object"==typeof a));return d.map(e)}},79309,a=>{"use strict";a.s(["getTimezoneOffsetInMilliseconds",()=>c]);var b=a.i(99602);function c(a){let c=(0,b.toDate)(a),d=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()));return d.setUTCFullYear(c.getFullYear()),a-d}},90449,a=>{"use strict";a.s(["differenceInCalendarDays",()=>g],90449);var b=a.i(79309),c=a.i(47355),d=a.i(96818),e=a.i(99602);function f(a,b){let c=(0,e.toDate)(a,b?.in);return c.setHours(0,0,0,0),c}function g(a,e,g){let[h,i]=(0,c.normalizeDates)(g?.in,a,e),j=f(h),k=f(i);return Math.round((j-(0,b.getTimezoneOffsetInMilliseconds)(j)-(k-(0,b.getTimezoneOffsetInMilliseconds)(k)))/d.millisecondsInDay)}},30539,a=>{"use strict";a.s(["default",()=>j],30539);var b=a.i(7997);function c(a){return b=>{let c=(a?Math[a]:Math.trunc)(b);return 0===c?0:c}}var d=a.i(96818),e=a.i(99602),f=a.i(47355),g=a.i(90449);function h(a,b){let c=a.getFullYear()-b.getFullYear()||a.getMonth()-b.getMonth()||a.getDate()-b.getDate()||a.getHours()-b.getHours()||a.getMinutes()-b.getMinutes()||a.getSeconds()-b.getSeconds()||a.getMilliseconds()-b.getMilliseconds();return c<0?-1:c>0?1:c}var i=a.i(27649);function j({profiles:a,lastMessages:j}){return(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Messages"}),a.map(a=>{let k=j.find(b=>b.contactId===a.id),l=k?.message;return(0,b.jsx)(i.default,{href:`/inbox/${a.id}`,children:(0,b.jsx)("div",{className:"p-4 border-b border-gray-300 hover:bg-gray-100 cursor-pointer",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("img",{src:a.avatar||"",alt:"",className:"w-12 h-12 rounded-full"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:a.username}),l&&(0,b.jsxs)("div",{className:"flex gap-1 text-sm text-gray-600",children:[(0,b.jsx)("span",{className:"truncate max-w-[200px]",children:l.content}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsx)("span",{children:function(a){let b=new Date,i=function(a,b,f){let g=((0,e.toDate)(a)-(0,e.toDate)(b))/d.millisecondsInMinute;return c(void 0)(g)}(b,a),j=function(a,b,e){let[g,h]=(0,f.normalizeDates)(void 0,a,b),i=(g-h)/d.millisecondsInHour;return c(void 0)(i)}(b,a),k=function(a,b,c){let[d,e]=(0,f.normalizeDates)(void 0,a,b),i=h(d,e),j=Math.abs((0,g.differenceInCalendarDays)(d,e));d.setDate(d.getDate()-i*j);let k=Number(h(d,e)===-i),l=i*(j-k);return 0===l?0:l}(b,a);return k>0?`${k}d`:j>0?`${j}h`:i>0?`${i}m`:"just now"}(l.createdAt)})]})]})]})})},a.id)})]})}},46410,a=>{"use strict";a.s(["default",()=>f]);var b=a.i(7997),c=a.i(77607),d=a.i(30539),e=a.i(42083);async function f(){let a=await (0,c.auth)();if(!a?.user?.email)return(0,b.jsx)("div",{children:"Please log in."});let f=await e.prisma.profile.findFirstOrThrow({where:{email:a?.user?.email}}),g=[...new Set((await e.prisma.message.findMany({where:{OR:[{senderId:f.id},{receiverId:f.id}]}})).map(a=>a.receiverId===f.id?a.senderId:a.receiverId))],h=await e.prisma.profile.findMany({where:{id:{in:g}}}),i=await Promise.all(g.map(async a=>{let b=await e.prisma.message.findFirst({where:{OR:[{senderId:f.id,receiverId:a},{senderId:a,receiverId:f.id}]},orderBy:{createdAt:"desc"}});return{contactId:a,message:b}}));return(0,b.jsx)(d.default,{profiles:h,lastMessages:i})}}];

//# sourceMappingURL=_35ce28af._.js.map